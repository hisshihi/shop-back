import{_ as M,k as U,l as D,u as I,r as _,p as R,q as F,h as C,c as d,a as e,w as f,v as O,C as w,F as b,e as h,i as c,D as Q,t as p,A as z,o as l,z as E,P as L}from"./index-BuGE99hL.js";const N={class:"catalog-view"},j={class:"container"},G={class:"catalog-container"},H={class:"catalog-sidebar"},J={class:"filter-section"},K={class:"search-container"},W={class:"filter-section"},X={class:"category-list"},Y={class:"category-item"},Z=["id","value"],ee=["for"],te={class:"filter-section"},ae=["value"],se={class:"catalog-content"},oe={key:0,class:"loading-container"},le={key:1,class:"error-message"},ie={key:2,class:"no-products"},ne={key:3},de={class:"pagination pagination-top"},re=["disabled"],ue={class:"pagination-info"},ce=["disabled"],ve={class:"products-grid"},pe={class:"pagination pagination-bottom"},ge=["disabled"],_e={class:"pagination-info"},fe=["disabled"],m=12,ye={__name:"CatalogView",setup(be){const r=F(),q=z(),i=U(),S=D(),P=I(),{fetchProducts:V,fetchCategories:T,addToCart:$}=i,v=_(""),n=_(""),u=_("default"),s=_(1),x=[{value:"default",label:"По умолчанию"},{value:"price_asc",label:"Цена: по возрастанию"},{value:"price_desc",label:"Цена: по убыванию"},{value:"name_asc",label:"Название: А-Я"},{value:"name_desc",label:"Название: Я-А"}];R(async()=>{await T(),P.isAuthenticated&&await S.fetchCartItems(),r.query.search&&(v.value=r.query.search),r.query.category&&(n.value=r.query.category),r.query.sort&&(u.value=r.query.sort),r.query.page&&(s.value=parseInt(r.query.page)||1),await y()}),C([v,n,u],async()=>{s.value=1,k(),await y()},{deep:!0}),C(s,async()=>{k(),await y(),window.scrollTo({top:0,behavior:"smooth"})});function k(){const o={};v.value&&(o.search=v.value),n.value&&(o.category=n.value),u.value!=="default"&&(o.sort=u.value),s.value>1&&(o.page=s.value),q.replace({query:o})}async function y(){const o={search:v.value||void 0,category:n.value||void 0,sort:u.value!=="default"?u.value:void 0,page:s.value,limit:m};await V(o)}function A(o){$(o)}function g(o){o>0&&(s.value=o)}return(o,t)=>(l(),d("div",N,[e("div",j,[t[13]||(t[13]=e("h1",{class:"page-title"},"Каталог товаров",-1)),e("div",G,[e("aside",H,[e("div",J,[t[8]||(t[8]=e("h3",{class:"filter-title"},"Поиск",-1)),e("div",K,[f(e("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=a=>v.value=a),placeholder:"Поиск товаров...",class:"search-input"},null,512),[[O,v.value]])])]),e("div",W,[t[10]||(t[10]=e("h3",{class:"filter-title"},"Категории",-1)),e("div",X,[e("div",Y,[f(e("input",{type:"radio",id:"category-all",name:"category",value:"","onUpdate:modelValue":t[1]||(t[1]=a=>n.value=a)},null,512),[[w,n.value]]),t[9]||(t[9]=e("label",{for:"category-all"},"Все категории",-1))]),(l(!0),d(b,null,h(c(i).categories,a=>(l(),d("div",{key:a.id,class:"category-item"},[f(e("input",{type:"radio",id:`category-${a.id}`,name:"category",value:a.id,"onUpdate:modelValue":t[2]||(t[2]=B=>n.value=B)},null,8,Z),[[w,n.value]]),e("label",{for:`category-${a.id}`},p(a.name),9,ee)]))),128))])]),e("div",te,[t[11]||(t[11]=e("h3",{class:"filter-title"},"Сортировка",-1)),f(e("select",{"onUpdate:modelValue":t[3]||(t[3]=a=>u.value=a),class:"filter-select"},[(l(),d(b,null,h(x,a=>e("option",{key:a.value,value:a.value},p(a.label),9,ae)),64))],512),[[Q,u.value]])])]),e("main",se,[c(i).loading?(l(),d("div",oe,t[12]||(t[12]=[e("div",{class:"loading-spinner"},null,-1),e("p",null,"Загрузка товаров...",-1)]))):c(i).error?(l(),d("p",le,p(c(i).error),1)):c(i).products.length===0?(l(),d("p",ie," Товары не найдены. Попробуйте изменить параметры поиска. ")):(l(),d("div",ne,[e("div",de,[e("button",{class:"pagination-btn",disabled:s.value===1,onClick:t[4]||(t[4]=a=>g(s.value-1))}," « Назад ",8,re),e("span",ue,"Страница "+p(s.value),1),e("button",{class:"pagination-btn",disabled:c(i).products.length<m,onClick:t[5]||(t[5]=a=>g(s.value+1))}," Вперед » ",8,ce)]),e("div",ve,[(l(!0),d(b,null,h(c(i).products,a=>(l(),E(L,{key:a.id,product:a,onAddToCart:A},null,8,["product"]))),128))]),e("div",pe,[e("button",{class:"pagination-btn",disabled:s.value===1,onClick:t[6]||(t[6]=a=>g(s.value-1))}," « Назад ",8,ge),e("span",_e,"Страница "+p(s.value),1),e("button",{class:"pagination-btn",disabled:c(i).products.length<m,onClick:t[7]||(t[7]=a=>g(s.value+1))}," Вперед » ",8,fe)])]))])])])]))}},me=M(ye,[["__scopeId","data-v-40a23141"]]);export{me as default};
